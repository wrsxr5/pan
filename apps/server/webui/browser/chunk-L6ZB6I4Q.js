import{a as k,b as u}from"./chunk-SYLXAYEM.js";import{F as l}from"./chunk-VUNKUA53.js";import{$ as n,B as m,Q as p,T as s,W as i,i as a,o as h,t as f}from"./chunk-S4OIF5WA.js";var d="BOOKMARK_CHANGED",N=(()=>{class o{configService;eventService;CONFIG_KEY="BOOKMARK";bookmarks=null;constructor(t,e){this.configService=t,this.eventService=e}getConfig=u(()=>this.configService.getConfig(this.CONFIG_KEY).pipe(f(t=>t?.bookmarks||[]),s(t=>this.bookmarks=t)));get(){return this.bookmarks===null?this.getConfig():h(this.bookmarks)}setConfig(){return this.bookmarks===null?this.getConfig():this.configService.setConfig({key:this.CONFIG_KEY,config:{bookmarks:this.bookmarks}}).pipe(p(()=>this.getConfig()),s(()=>this.eventService.emit(d)))}add(t){this.bookmarks===null||this.bookmarks.some(e=>e.path===t.path)||(this.bookmarks.push(t),this.setConfig().subscribe())}remove(t){this.bookmarks===null||!this.bookmarks.some(e=>e.path===t.path)||(this.bookmarks=this.bookmarks.filter(e=>e.path!==t.path),this.setConfig().subscribe())}static \u0275fac=function(e){return new(e||o)(n(l),n(k))};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var G=(()=>{class o{socket=null;subject=new a;event=this.subject.asObservable();ngOnDestroy(){this.socket?.close(),this.subject.complete()}on(t){return this.event.pipe(m(e=>e.topic===t))}constructor(){let{protocol:t,hostname:e,port:c}=window.location,b=`${t==="https:"?"wss:":"ws:"}//${e}${c?`:${c}`:""}/ws`;this.socket=new WebSocket(b),this.socket.addEventListener("message",r=>{try{this.subject.next(JSON.parse(r.data))}catch(v){console.error(v)}}),this.socket.addEventListener("error",r=>{this.subject.error(r)}),this.socket.addEventListener("close",()=>{this.subject.complete()})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();export{G as a,d as b,N as c};
